[32m2023-08-05 07:41:10.837[39m | [1mINFO    [22m | [36m__main__[39m:[36mreport_setting[39m:[36m254[39m - [1mmodel: GCRN
[32m2023-08-05 07:41:10.838[39m | [1mINFO    [22m | [36m__main__[39m:[36mreport_setting[39m:[36m254[39m - [1mdataset: WikiElec
[32m2023-08-05 07:41:10.839[39m | [1mINFO    [22m | [36m__main__[39m:[36mreport_setting[39m:[36m254[39m - [1maugment_method: none
[32m2023-08-05 07:41:10.839[39m | [1mINFO    [22m | [36m__main__[39m:[36mreport_setting[39m:[36m254[39m - [1mepochs: 200
[32m2023-08-05 07:41:10.839[39m | [1mINFO    [22m | [36m__main__[39m:[36mreport_setting[39m:[36m254[39m - [1mearly_stopping: 50
[32m2023-08-05 07:41:10.840[39m | [1mINFO    [22m | [36m__main__[39m:[36mreport_setting[39m:[36m254[39m - [1mnum_layers: 2
[32m2023-08-05 07:41:10.840[39m | [1mINFO    [22m | [36m__main__[39m:[36mreport_setting[39m:[36m254[39m - [1mlr: 0.05
[32m2023-08-05 07:41:10.840[39m | [1mINFO    [22m | [36m__main__[39m:[36mreport_setting[39m:[36m254[39m - [1mrnn: LSTM
[32m2023-08-05 07:41:10.841[39m | [1mINFO    [22m | [36m__main__[39m:[36mreport_setting[39m:[36m254[39m - [1mdropout: 0.0
[32m2023-08-05 07:41:10.841[39m | [1mINFO    [22m | [36m__main__[39m:[36mreport_setting[39m:[36m254[39m - [1mconf_file: settings/GCRN-WikiElec-none.json
[32m2023-08-05 07:41:10.841[39m | [1mINFO    [22m | [36m__main__[39m:[36mreport_setting[39m:[36m254[39m - [1mseed: 117
[32m2023-08-05 07:41:13.102[39m | [1mINFO    [22m | [36mdataset_loader.template[39m:[36mload[39m:[36m137[39m - [1mTemporalGraph(WikiElec, num_nodes=7125, num_edges=212856, num_timesteps=100)

epoch:   0%|▌                                                                                                               | 1/200 [00:02<08:04,  2.43s/it]
train loss:  0.7015, train metric:  0.5176, val loss:  0.7370, val metric:  0.4292, test loss:  0.7370, test metric:  0.4390

epoch:   1%|█                                                                                                               | 2/200 [00:03<06:08,  1.86s/it]

epoch:   2%|██▏                                                                                                             | 4/200 [00:07<05:22,  1.65s/it]

epoch:   2%|██▊                                                                                                             | 5/200 [00:08<05:08,  1.58s/it]

epoch:   3%|███▎                                                                                                            | 6/200 [00:10<05:11,  1.61s/it]
train loss:  0.7082, train metric:  0.5551, val loss:  0.6982, val metric:  0.4438, test loss:  0.6982, test metric:  0.4342

epoch:   4%|███▉                                                                                                            | 7/200 [00:11<05:03,  1.57s/it]

epoch:   4%|█████                                                                                                           | 9/200 [00:14<04:55,  1.55s/it]

epoch:   5%|█████▌                                                                                                         | 10/200 [00:16<04:59,  1.58s/it]
train loss:  0.6936, train metric:    0.61, val loss:  0.6947, val metric:  0.5000, test loss:  0.6947, test metric:  0.5000

epoch:   6%|██████                                                                                                         | 11/200 [00:17<04:54,  1.56s/it]

epoch:   6%|███████▏                                                                                                       | 13/200 [00:20<04:52,  1.57s/it]

epoch:   7%|███████▊                                                                                                       | 14/200 [00:22<04:46,  1.54s/it]

epoch:   8%|████████▎                                                                                                      | 15/200 [00:24<04:53,  1.59s/it]
train loss:  0.6894, train metric:  0.6195, val loss:  0.6932, val metric:  0.5000, test loss:  0.6932, test metric:  0.5000

epoch:   8%|█████████▍                                                                                                     | 17/200 [00:27<04:41,  1.54s/it]

epoch:   9%|█████████▉                                                                                                     | 18/200 [00:28<04:46,  1.58s/it]

epoch:  10%|██████████▌                                                                                                    | 19/200 [00:30<04:42,  1.56s/it]

epoch:  10%|███████████                                                                                                    | 20/200 [00:32<04:47,  1.60s/it]
train loss:  0.6623, train metric:  0.6593, val loss:  0.7034, val metric:  0.5487, test loss:  0.7079, test metric:  0.5205

epoch:  11%|████████████▏                                                                                                  | 22/200 [00:35<04:35,  1.55s/it]

epoch:  12%|████████████▊                                                                                                  | 23/200 [00:36<04:41,  1.59s/it]

epoch:  12%|█████████████▎                                                                                                 | 24/200 [00:38<04:36,  1.57s/it]
train loss:  0.6237, train metric:  0.6969, val loss:  0.6896, val metric:  0.6124, test loss:  0.7040, test metric:  0.5721

epoch:  12%|█████████████▉                                                                                                 | 25/200 [00:39<04:39,  1.60s/it]

epoch:  14%|██████████████▉                                                                                                | 27/200 [00:43<04:40,  1.62s/it]

epoch:  14%|███████████████▌                                                                                               | 28/200 [00:44<04:33,  1.59s/it]

epoch:  14%|████████████████                                                                                               | 29/200 [00:46<04:28,  1.57s/it]
train loss:  0.5840, train metric:  0.7587, val loss:  0.6595, val metric:  0.6575, test loss:  0.6664, test metric:  0.6234

epoch:  15%|████████████████▋                                                                                              | 30/200 [00:47<04:31,  1.60s/it]

epoch:  16%|█████████████████▊                                                                                             | 32/200 [00:50<04:26,  1.58s/it]

epoch:  16%|██████████████████▎                                                                                            | 33/200 [00:52<04:18,  1.55s/it]

epoch:  17%|██████████████████▊                                                                                            | 34/200 [00:54<04:23,  1.59s/it]
train loss:  0.5534, train metric:  0.7927, val loss:  0.6668, val metric:  0.6736, test loss:  0.6855, test metric:  0.6498

epoch:  18%|███████████████████▉                                                                                           | 36/200 [00:57<04:10,  1.53s/it]

epoch:  18%|████████████████████▌                                                                                          | 37/200 [00:58<04:14,  1.56s/it]

epoch:  19%|█████████████████████                                                                                          | 38/200 [01:00<04:05,  1.52s/it]
train loss:  0.5203, train metric:  0.8232, val loss:  0.6415, val metric:  0.7089, test loss:  0.6655, test metric:  0.6894

epoch:  20%|██████████████████████▏                                                                                        | 40/200 [01:03<04:03,  1.52s/it]

epoch:  20%|██████████████████████▊                                                                                        | 41/200 [01:04<04:08,  1.56s/it]

epoch:  21%|███████████████████████▎                                                                                       | 42/200 [01:06<04:01,  1.53s/it]
train loss:  0.5100, train metric:  0.8312, val loss:  0.6739, val metric:  0.7102, test loss:  0.6969, test metric:  0.7037

epoch:  22%|███████████████████████▊                                                                                       | 43/200 [01:07<03:57,  1.51s/it]

epoch:  22%|████████████████████████▉                                                                                      | 45/200 [01:10<03:55,  1.52s/it]

epoch:  23%|█████████████████████████▌                                                                                     | 46/200 [01:12<03:58,  1.55s/it]
train loss:  0.4807, train metric:  0.8519, val loss:  0.7429, val metric:  0.7022, test loss:  0.7894, test metric:  0.6907

epoch:  24%|██████████████████████████                                                                                     | 47/200 [01:14<03:57,  1.55s/it]

epoch:  24%|███████████████████████████▏                                                                                   | 49/200 [01:17<03:54,  1.55s/it]

epoch:  25%|███████████████████████████▊                                                                                   | 50/200 [01:18<03:48,  1.52s/it]

epoch:  26%|████████████████████████████▎                                                                                  | 51/200 [01:20<03:52,  1.56s/it]
train loss:  0.4565, train metric:  0.8713, val loss:  0.9040, val metric:  0.6592, test loss:  0.9541, test metric:  0.6519

epoch:  26%|█████████████████████████████▍                                                                                 | 53/200 [01:23<03:51,  1.58s/it]

epoch:  27%|█████████████████████████████▉                                                                                 | 54/200 [01:24<03:45,  1.54s/it]

epoch:  28%|██████████████████████████████▌                                                                                | 55/200 [01:26<03:39,  1.52s/it]
train loss:  0.4337, train metric:  0.8819, val loss:  0.9780, val metric:  0.6751, test loss:  1.0536, test metric:  0.6531

epoch:  28%|███████████████████████████████▋                                                                               | 57/200 [01:29<03:38,  1.53s/it]

epoch:  29%|████████████████████████████████▏                                                                              | 58/200 [01:31<03:44,  1.58s/it]

epoch:  30%|████████████████████████████████▋                                                                              | 59/200 [01:32<03:39,  1.55s/it]
train loss:  0.4143, train metric:  0.8915, val loss:  1.0303, val metric:  0.6772, test loss:  1.1252, test metric:  0.6466

epoch:  30%|█████████████████████████████████▎                                                                             | 60/200 [01:34<03:32,  1.52s/it]

epoch:  31%|██████████████████████████████████▍                                                                            | 62/200 [01:37<03:31,  1.54s/it]

epoch:  32%|██████████████████████████████████▉                                                                            | 63/200 [01:38<03:34,  1.57s/it]

epoch:  32%|███████████████████████████████████▌                                                                           | 64/200 [01:40<03:29,  1.54s/it]
train loss:  0.3918, train metric:  0.9053, val loss:  1.0045, val metric:  0.6789, test loss:  1.1137, test metric:  0.6445

epoch:  32%|████████████████████████████████████                                                                           | 65/200 [01:42<03:37,  1.61s/it]

epoch:  34%|█████████████████████████████████████▏                                                                         | 67/200 [01:45<03:26,  1.55s/it]

epoch:  34%|█████████████████████████████████████▋                                                                         | 68/200 [01:46<03:28,  1.58s/it]

epoch:  34%|██████████████████████████████████████▎                                                                        | 69/200 [01:48<03:23,  1.56s/it]
train loss:  0.3771, train metric:  0.9135, val loss:  1.0919, val metric:  0.6697, test loss:  1.1930, test metric:  0.6394

epoch:  36%|███████████████████████████████████████▍                                                                       | 71/200 [01:51<03:18,  1.54s/it]

epoch:  36%|███████████████████████████████████████▉                                                                       | 72/200 [01:53<03:23,  1.59s/it]
epoch:  36%|████████████████████████████████████████▌                                                                      | 73/200 [01:54<03:19,  1.57s/it]
Traceback (most recent call last):
  File "/mnt/share_nfs/my_method/custom_DIDA/src/main.py", line 258, in <module>
    if __name__ == "__main__":
  File "/compuworks/anaconda3/envs/py39_p2/lib/python3.9/site-packages/fire/core.py", line 141, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
  File "/compuworks/anaconda3/envs/py39_p2/lib/python3.9/site-packages/fire/core.py", line 475, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
  File "/compuworks/anaconda3/envs/py39_p2/lib/python3.9/site-packages/fire/core.py", line 691, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
  File "/mnt/share_nfs/my_method/custom_DIDA/src/main.py", line 236, in main_wraper
    wan = wandb.init(project="ours", config=setting)
  File "/mnt/share_nfs/my_method/custom_DIDA/src/main.py", line 207, in main
    model, decoder, history = trainer.train(
  File "/mnt/share_nfs/my_method/custom_DIDA/src/trainer.py", line 86, in train
    train_loss, train_metric = self.calc_loss_and_metrics("train", False)
  File "/mnt/share_nfs/my_method/custom_DIDA/src/trainer.py", line 164, in calc_loss_and_metrics
    return self.link_prediction(split, evaluate)
  File "/mnt/share_nfs/my_method/custom_DIDA/src/trainer.py", line 238, in link_prediction
    logits = self.decoder(embedding, pairs)
  File "/compuworks/anaconda3/envs/py39_p2/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/mnt/share_nfs/my_method/custom_DIDA/src/module/decoder.py", line 77, in forward
    to_emb = emb[idx[:, 1]]
KeyboardInterrupt
train loss:  0.3644, train metric:  0.9197, val loss:  1.1064, val metric:  0.6671, test loss:  1.2292, test metric:  0.6363