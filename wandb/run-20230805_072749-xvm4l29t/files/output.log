[32m2023-08-05 07:27:55.196[39m | [1mINFO    [22m | [36m__main__[39m:[36mreport_setting[39m:[36m256[39m - [1mmodel: GCRN
[32m2023-08-05 07:27:55.197[39m | [1mINFO    [22m | [36m__main__[39m:[36mreport_setting[39m:[36m256[39m - [1mdataset: WikiElec
[32m2023-08-05 07:27:55.197[39m | [1mINFO    [22m | [36m__main__[39m:[36mreport_setting[39m:[36m256[39m - [1maugment_method: none
[32m2023-08-05 07:27:55.198[39m | [1mINFO    [22m | [36m__main__[39m:[36mreport_setting[39m:[36m256[39m - [1mepochs: 200
[32m2023-08-05 07:27:55.198[39m | [1mINFO    [22m | [36m__main__[39m:[36mreport_setting[39m:[36m256[39m - [1mearly_stopping: 50
[32m2023-08-05 07:27:55.199[39m | [1mINFO    [22m | [36m__main__[39m:[36mreport_setting[39m:[36m256[39m - [1mnum_layers: 2
[32m2023-08-05 07:27:55.199[39m | [1mINFO    [22m | [36m__main__[39m:[36mreport_setting[39m:[36m256[39m - [1mlr: 0.05
[32m2023-08-05 07:27:55.199[39m | [1mINFO    [22m | [36m__main__[39m:[36mreport_setting[39m:[36m256[39m - [1mrnn: LSTM
[32m2023-08-05 07:27:55.200[39m | [1mINFO    [22m | [36m__main__[39m:[36mreport_setting[39m:[36m256[39m - [1mdropout: 0.0
[32m2023-08-05 07:27:55.200[39m | [1mINFO    [22m | [36m__main__[39m:[36mreport_setting[39m:[36m256[39m - [1mconf_file: settings/GCRN-WikiElec-none.json
[32m2023-08-05 07:27:55.200[39m | [1mINFO    [22m | [36m__main__[39m:[36mreport_setting[39m:[36m256[39m - [1mseed: 117
[32m2023-08-05 07:28:03.267[39m | [1mINFO    [22m | [36mdataset_loader.link[39m:[36mprocess[39m:[36m66[39m - [1mTemporalGraph(WikiElec, num_nodes=7125, num_edges=107013, num_timesteps=100)
> /mnt/share_nfs/my_method/custom_DIDA/src/main.py(157)main()
-> "input_dim": input_dim,
152  	
153  	    # build model
154  	
155  	    breakpoint()
156  	    model_arguments = {
157  ->	        "input_dim": input_dim,
158  	        "output_dim": output_dim,
159  	        "device": device,
160  	        "renorm_order": "sym",
161  	        **kwargs,
162  	    }

epoch:   0%|▌                                                                                                               | 1/200 [00:02<07:26,  2.24s/it]

epoch:   2%|█▋                                                                                                              | 3/200 [00:05<05:33,  1.69s/it]
train loss:  1.3983, train metric:  0.4472, val loss:  0.6930, val metric:  0.4990, test loss:  0.6933, test metric:  0.4878

epoch:   2%|██▏                                                                                                             | 4/200 [00:06<05:25,  1.66s/it]

epoch:   2%|██▊                                                                                                             | 5/200 [00:08<05:10,  1.59s/it]

epoch:   4%|███▉                                                                                                            | 7/200 [00:11<05:00,  1.56s/it]

epoch:   4%|████▍                                                                                                           | 8/200 [00:12<04:52,  1.52s/it]
train loss:  0.6994, train metric:  0.4676, val loss:  0.6966, val metric:  0.4782, test loss:  0.6966, test metric:  0.4769

epoch:   4%|█████                                                                                                           | 9/200 [00:14<04:59,  1.57s/it]

epoch:   5%|█████▌                                                                                                         | 10/200 [00:16<04:50,  1.53s/it]

epoch:   6%|██████▋                                                                                                        | 12/200 [00:19<04:47,  1.53s/it]
train loss:  0.6946, train metric:  0.4993, val loss:  0.6940, val metric:  0.5000, test loss:  0.6940, test metric:  0.4998

epoch:   6%|███████▏                                                                                                       | 13/200 [00:20<04:42,  1.51s/it]

epoch:   7%|███████▊                                                                                                       | 14/200 [00:22<04:46,  1.54s/it]

epoch:   8%|████████▉                                                                                                      | 16/200 [00:25<04:46,  1.55s/it]
train loss:  0.6886, train metric:   0.579, val loss:  0.6890, val metric:  0.6211, test loss:  0.6877, test metric:  0.6528

epoch:   8%|█████████▍                                                                                                     | 17/200 [00:26<04:38,  1.52s/it]

epoch:   9%|█████████▉                                                                                                     | 18/200 [00:28<04:40,  1.54s/it]

epoch:  10%|███████████                                                                                                    | 20/200 [00:31<04:29,  1.50s/it]
train loss:  0.6791, train metric:  0.6549, val loss:  0.7206, val metric:  0.5366, test loss:  0.7230, test metric:  0.5114

epoch:  10%|███████████▋                                                                                                   | 21/200 [00:32<04:32,  1.52s/it]

epoch:  11%|████████████▏                                                                                                  | 22/200 [00:34<04:27,  1.51s/it]

epoch:  12%|█████████████▎                                                                                                 | 24/200 [00:37<04:26,  1.51s/it]
train loss:  0.6568, train metric:  0.7268, val loss:  0.6895, val metric:  0.6479, test loss:  0.6947, test metric:  0.6337

epoch:  12%|█████████████▉                                                                                                 | 25/200 [00:38<04:21,  1.49s/it]

epoch:  13%|██████████████▍                                                                                                | 26/200 [00:40<04:26,  1.53s/it]

epoch:  14%|██████████████▉                                                                                                | 27/200 [00:41<04:20,  1.51s/it]
train loss:  0.6215, train metric:  0.7676, val loss:  0.6957, val metric:  0.6734, test loss:  0.7116, test metric:  0.6531
Program interrupted. (Use 'cont' to resume).
> /compuworks/anaconda3/envs/py39_p2/lib/python3.9/site-packages/torch_geometric/nn/conv/message_passing.py(220)_check_input()
epoch:  14%|██████████████▉                                                                                                | 27/200 [00:44<04:44,  1.64s/it]
Traceback (most recent call last):
  File "/mnt/share_nfs/my_method/custom_DIDA/src/main.py", line 260, in <module>
    Fire(main_wraper)
  File "/compuworks/anaconda3/envs/py39_p2/lib/python3.9/site-packages/fire/core.py", line 141, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
  File "/compuworks/anaconda3/envs/py39_p2/lib/python3.9/site-packages/fire/core.py", line 475, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
  File "/compuworks/anaconda3/envs/py39_p2/lib/python3.9/site-packages/fire/core.py", line 691, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
  File "/mnt/share_nfs/my_method/custom_DIDA/src/main.py", line 238, in main_wraper
    test_metric, history = main(**setting)
  File "/mnt/share_nfs/my_method/custom_DIDA/src/main.py", line 157, in main
    "input_dim": input_dim,
  File "/mnt/share_nfs/my_method/custom_DIDA/src/trainer.py", line 109, in train
    val_loss, val_metric = self.calc_loss_and_metrics('val', True)
  File "/mnt/share_nfs/my_method/custom_DIDA/src/trainer.py", line 168, in calc_loss_and_metrics
    return self.link_prediction(split, evaluate)
  File "/mnt/share_nfs/my_method/custom_DIDA/src/trainer.py", line 235, in link_prediction
    embedding = self.model(self.dataset, input_start, input_end)
  File "/compuworks/anaconda3/envs/py39_p2/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/mnt/share_nfs/my_method/custom_DIDA/src/module/model/GCRN.py", line 135, in forward
    H, C = layer(feat, indices, H=H, C=C, edge_weight=graph.edata['w'])
  File "/compuworks/anaconda3/envs/py39_p2/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/mnt/share_nfs/my_method/custom_DIDA/src/module/model/GCRN.py", line 462, in forward
    I = self._calculate_input_gate(X, edge_index, edge_weight, H, C)
  File "/mnt/share_nfs/my_method/custom_DIDA/src/module/model/GCRN.py", line 400, in _calculate_input_gate
    I = I + self.conv_h_i(H, edge_index, edge_weight)
  File "/compuworks/anaconda3/envs/py39_p2/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/compuworks/anaconda3/envs/py39_p2/lib/python3.9/site-packages/torch_geometric/nn/conv/gcn_conv.py", line 232, in forward
    out = self.propagate(edge_index, x=x, edge_weight=edge_weight,
  File "/compuworks/anaconda3/envs/py39_p2/lib/python3.9/site-packages/torch_geometric/nn/conv/message_passing.py", line 422, in propagate
    size = self._check_input(edge_index, size)
  File "/compuworks/anaconda3/envs/py39_p2/lib/python3.9/site-packages/torch_geometric/nn/conv/message_passing.py", line 220, in _check_input
    if edge_index.dtype not in int_dtypes:
  File "/compuworks/anaconda3/envs/py39_p2/lib/python3.9/site-packages/torch_geometric/nn/conv/message_passing.py", line 220, in _check_input
    if edge_index.dtype not in int_dtypes:
  File "/compuworks/anaconda3/envs/py39_p2/lib/python3.9/bdb.py", line 88, in trace_dispatch
    return self.dispatch_line(frame)
  File "/compuworks/anaconda3/envs/py39_p2/lib/python3.9/bdb.py", line 113, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit